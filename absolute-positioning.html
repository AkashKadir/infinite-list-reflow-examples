<html>
<head>
  <link rel="stylesheet" type="text/css" href="shared.css" />
</head>
<body>
  <div id="container"></div>

  <script type="text/javascript" src="absolute-positioning.js"></script>
  <script type="text/javascript">
    fetch('./books.json')
      .then(response => response.json())
      .then(booksJSON => {
        const container = document.getElementById('container');

        function createItem(container) {
          const link = document.createElement('a');
          link.className = 'link';


          const authors = document.createElement('span');
          authors.className = 'authors';

          const description = document.createElement('p');
          description.className = 'description';

          container.appendChild(link);
          container.appendChild(authors);
          container.appendChild(description);
        }

        function updateItem(container, index) {
          const bookJSON = booksJSON[index];

          const link = container.querySelector('.link');
          link.href = `https://www.amazon.com/s/ref=nb_sb_noss?url=search-alias%3Daps&field-keywords=${escape(bookJSON.title)}`
          link.text = bookJSON.title;

          const authors = container.querySelector('.authors');
          authors.innerText = ` by ${bookJSON.authors.join(', ')}`;

          const description = container.querySelector('.description');
          description.innerText = bookJSON.longDescription || bookJSON.shortDescription || 'N/A';
        }

        createList(container, booksJSON.length, createItem, updateItem);
      });
  </script>
</body>
</html>